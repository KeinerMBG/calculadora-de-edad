<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">
  <title>Edad By Keiner</title>
  <link rel="manifest" href="#" id="manifest">
  <link rel="apple-touch-icon" href="/api/placeholder/180/180">
  <style>
    :root {
      --primary-color: #007AFF;
      --background-color: #F2F2F7;
      --card-bg: #ffffff;
      --text-color: #1C1C1E;
      --secondary-text: #8E8E93;
      --border-radius: 16px;
      --transition-time: 0.3s;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --background-color: #000000;
        --card-bg: #1C1C1E;
        --text-color: #FFFFFF;
        --secondary-text: #8E8E93;
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
      transition: all var(--transition-time) ease;
      overscroll-behavior-y: none;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 16px;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 12px 0;
      margin-bottom: 24px;
    }

    h1 {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(90deg, #007AFF, #5E5CE6);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 4px;
    }

    .card {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      transition: transform var(--transition-time) ease, box-shadow var(--transition-time) ease;
    }

    .card:active {
      transform: scale(0.98);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--secondary-text);
    }

    input, button {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      border: 1px solid rgba(128, 128, 128, 0.2);
      background-color: rgba(128, 128, 128, 0.1);
      color: var(--text-color);
      font-size: 16px;
      margin-bottom: 12px;
      transition: all var(--transition-time) ease;
    }

    input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
    }

    button {
      background-color: var(--primary-color);
      border: none;
      color: white;
      font-weight: 600;
      cursor: pointer;
    }

    button:active {
      transform: scale(0.96);
      background-color: #0066CC;
    }

    .tabs {
      display: flex;
      border-radius: var(--border-radius);
      background-color: rgba(128, 128, 128, 0.1);
      margin-bottom: 20px;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .tab {
      flex: 1;
      padding: 16px;
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-time) ease;
      color: var(--secondary-text);
      font-weight: 500;
    }

    .tab.active {
      color: var(--primary-color);
      font-weight: 600;
    }

    .tab-indicator {
      height: 4px;
      width: 50%;
      background-color: var(--primary-color);
      border-radius: 4px;
      transition: transform var(--transition-time) cubic-bezier(0.22, 1, 0.36, 1);
    }

    .view {
      display: none;
      opacity: 0;
      transform: translateY(10px);
      transition: all var(--transition-time) ease;
    }

    .view.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }

    .results {
      margin-top: 24px;
    }

    .age-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(128, 128, 128, 0.1);
    }

    .age-item:last-child {
      border-bottom: none;
    }

    .age-label {
      font-weight: 500;
      color: var(--secondary-text);
    }

    .age-value {
      font-weight: 600;
    }

    .person-card {
      padding: 16px;
      margin-bottom: 16px;
      border-radius: var(--border-radius);
      background-color: var(--card-bg);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      animation: slideIn var(--transition-time) ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .person-name {
      font-weight: 600;
      font-size: 18px;
      margin-bottom: 4px;
    }

    .person-birthdate {
      color: var(--secondary-text);
      margin-bottom: 12px;
    }

    .person-age {
      font-weight: 500;
    }

    .delete-btn {
      background-color: #FF3B30;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      font-size: 14px;
      margin-top: 8px;
    }

    .empty-state {
      text-align: center;
      padding: 40px 0;
      color: var(--secondary-text);
    }

    .progress-bar {
      height: 4px;
      background-color: rgba(0, 122, 255, 0.2);
      border-radius: 2px;
      margin: 12px 0;
      overflow: hidden;
    }

    .progress {
      height: 100%;
      background-color: var(--primary-color);
      width: 0;
      transition: width 1s linear;
    }

    .live-update {
      color: var(--primary-color);
      font-weight: 500;
      font-size: 12px;
      margin-top: 4px;
      text-align: right;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Edad By Keiner</h1>
    </header>

    <div class="tabs">
      <div class="tab active" data-tab="calculator">Calculadora</div>
      <div class="tab" data-tab="records">Registros</div>
    </div>
    <div style="position: relative; height: 4px; background: rgba(128, 128, 128, 0.1); border-radius: 4px; margin-bottom: 20px;">
      <div class="tab-indicator"></div>
    </div>

    <div class="view active" id="calculator-view">
      <div class="card">
        <label for="name">Nombre</label>
        <input type="text" id="name" placeholder="Ingresa un nombre">
        
        <label for="birthdate">Fecha de nacimiento</label>
        <input type="date" id="birthdate">
        
        <button id="calculate-btn">Calcular edad</button>
        <button id="save-btn">Guardar persona</button>
      </div>

      <div class="results card" id="results" style="display: none;">
        <div class="age-item">
          <span class="age-label">Años:</span>
          <span class="age-value" id="years">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Meses:</span>
          <span class="age-value" id="months">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Semanas:</span>
          <span class="age-value" id="weeks">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Días:</span>
          <span class="age-value" id="days">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Horas:</span>
          <span class="age-value" id="hours">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Minutos:</span>
          <span class="age-value" id="minutes">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Segundos:</span>
          <span class="age-value" id="seconds">--</span>
        </div>
        <div class="age-item">
          <span class="age-label">Milisegundos:</span>
          <span class="age-value" id="milliseconds">--</span>
        </div>

        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
        <div class="live-update">Actualizando en tiempo real</div>
      </div>
    </div>

    <div class="view" id="records-view">
      <div class="card">
        <h2>Personas guardadas</h2>
        <div id="people-list"></div>
      </div>
    </div>
  </div>

  <script>
    // Manifest generado dinámicamente
    const manifestData = {
      "name": "Edad By Keiner",
      "short_name": "Edad",
      "start_url": ".",
      "display": "standalone",
      "background_color": "#000000",
      "theme_color": "#007AFF",
      "icons": [
        {
          "src": "/api/placeholder/192/192",
          "sizes": "192x192",
          "type": "image/png"
        },
        {
          "src": "/api/placeholder/512/512",
          "sizes": "512x512",
          "type": "image/png"
        }
      ]
    };

    // Crear el manifest como Blob
    const manifestBlob = new Blob([JSON.stringify(manifestData)], {type: 'application/json'});
    const manifestURL = URL.createObjectURL(manifestBlob);
    document.getElementById('manifest').setAttribute('href', manifestURL);

    // Service Worker para PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js').catch(error => {
        console.log('Service Worker registration failed:', error);
      });
    }

    // Variables y funciones
    let people = JSON.parse(localStorage.getItem('people') || '[]');
    let updateInterval;

    // Elementos de la UI
    const tabs = document.querySelectorAll('.tab');
    const views = document.querySelectorAll('.view');
    const tabIndicator = document.querySelector('.tab-indicator');
    
    // Elementos del formulario
    const nameInput = document.getElementById('name');
    const birthdateInput = document.getElementById('birthdate');
    const calculateBtn = document.getElementById('calculate-btn');
    const saveBtn = document.getElementById('save-btn');
    const resultsDiv = document.getElementById('results');
    
    // Funciones de navegación
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Actualizar tabs
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        // Mover el indicador
        const tabPosition = Array.from(tabs).indexOf(tab);
        tabIndicator.style.transform = `translateX(${tabPosition * 100}%)`;
        
        // Actualizar vistas
        const targetTab = tab.dataset.tab;
        views.forEach(view => {
          view.classList.remove('active');
          if (view.id === `${targetTab}-view`) {
            view.classList.add('active');
          }
        });
        
        // Cargar datos de personas si estamos en la pestaña de registros
        if (targetTab === 'records') {
          renderPeopleList();
        }
        
        // Detener actualización en tiempo real si cambiamos de pestaña
        if (targetTab !== 'calculator') {
          clearInterval(updateInterval);
        }
      });
    });

    // Función para calcular la edad
    function calculateAge(birthdate) {
      const birthDate = new Date(birthdate);
      const now = new Date();
      
      const diffMs = now - birthDate;
      
      const msInSecond = 1000;
      const msInMinute = msInSecond * 60;
      const msInHour = msInMinute * 60;
      const msInDay = msInHour * 24;
      const msInWeek = msInDay * 7;
      const msInMonth = msInDay * 30.44; // Aproximación
      const msInYear = msInDay * 365.25; // Incluye años bisiestos
      
      const years = Math.floor(diffMs / msInYear);
      const months = Math.floor(diffMs / msInMonth);
      const weeks = Math.floor(diffMs / msInWeek);
      const days = Math.floor(diffMs / msInDay);
      const hours = Math.floor(diffMs / msInHour);
      const minutes = Math.floor(diffMs / msInMinute);
      const seconds = Math.floor(diffMs / msInSecond);
      const milliseconds = diffMs;
      
      return {
        years,
        months,
        weeks,
        days,
        hours,
        minutes,
        seconds,
        milliseconds
      };
    }

    // Mostrar los resultados del cálculo
    function displayResults(ageData) {
      document.getElementById('years').textContent = ageData.years.toLocaleString();
      document.getElementById('months').textContent = ageData.months.toLocaleString();
      document.getElementById('weeks').textContent = ageData.weeks.toLocaleString();
      document.getElementById('days').textContent = ageData.days.toLocaleString();
      document.getElementById('hours').textContent = ageData.hours.toLocaleString();
      document.getElementById('minutes').textContent = ageData.minutes.toLocaleString();
      document.getElementById('seconds').textContent = ageData.seconds.toLocaleString();
      document.getElementById('milliseconds').textContent = ageData.milliseconds.toLocaleString();
      
      document.getElementById('progress').style.width = `${Math.floor(Math.random() * 50) + 50}%`;
      
      // Mostrar los resultados con una animación
      if (resultsDiv.style.display === 'none') {
        resultsDiv.style.display = 'block';
        setTimeout(() => {
          resultsDiv.style.opacity = '1';
          resultsDiv.style.transform = 'translateY(0)';
        }, 10);
      }
    }

    // Iniciar actualización en tiempo real
    function startLiveUpdate(birthdate) {
      clearInterval(updateInterval);
      updateInterval = setInterval(() => {
        const ageData = calculateAge(birthdate);
        displayResults(ageData);
      }, 100); // Actualizar cada 100ms para ver los milisegundos cambiar
    }

    // Guardar persona
    function savePerson() {
      const name = nameInput.value.trim();
      const birthdate = birthdateInput.value;
      
      if (!name || !birthdate) {
        alert('Por favor completa todos los campos');
        return;
      }
      
      const person = {
        id: Date.now(),
        name,
        birthdate
      };
      
      people.push(person);
      localStorage.setItem('people', JSON.stringify(people));
      
      // Mostrar mensaje de éxito con animación
      const saveBtn = document.getElementById('save-btn');
      const originalText = saveBtn.textContent;
      saveBtn.textContent = '¡Guardado!';
      saveBtn.style.backgroundColor = '#34C759';
      
      setTimeout(() => {
        saveBtn.textContent = originalText;
        saveBtn.style.backgroundColor = '';
      }, 1500);
      
      // Limpiar campos
      nameInput.value = '';
    }

    // Renderizar lista de personas
    function renderPeopleList() {
      const peopleList = document.getElementById('people-list');
      peopleList.innerHTML = '';
      
      if (people.length === 0) {
        peopleList.innerHTML = '<div class="empty-state">No hay personas guardadas</div>';
        return;
      }
      
      people.forEach((person, index) => {
        const ageData = calculateAge(person.birthdate);
        const personDate = new Date(person.birthdate);
        
        const personCard = document.createElement('div');
        personCard.className = 'person-card';
        personCard.style.animationDelay = `${index * 0.1}s`;
        
        personCard.innerHTML = `
          <div class="person-name">${person.name}</div>
          <div class="person-birthdate">${personDate.toLocaleDateString()}</div>
          <div class="person-age">Edad: ${ageData.years} años</div>
          <button class="delete-btn" data-id="${person.id}">Eliminar</button>
        `;
        
        peopleList.appendChild(personCard);
      });
      
      // Añadir listeners para eliminar
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const id = parseInt(e.target.dataset.id);
          people = people.filter(person => person.id !== id);
          localStorage.setItem('people', JSON.stringify(people));
          renderPeopleList();
        });
      });
    }

    // Event listeners
    calculateBtn.addEventListener('click', () => {
      const birthdate = birthdateInput.value;
      
      if (!birthdate) {
        alert('Por favor selecciona una fecha de nacimiento');
        return;
      }
      
      const ageData = calculateAge(birthdate);
      displayResults(ageData);
      startLiveUpdate(birthdate);
    });
    
    saveBtn.addEventListener('click', savePerson);
    
    // Inicializar fecha por defecto
    const today = new Date();
    const yyyy = today.getFullYear();
    let mm = today.getMonth() + 1;
    let dd = today.getDate();
    
    if (mm < 10) mm = '0' + mm;
    if (dd < 10) dd = '0' + dd;
    
    const formattedToday = yyyy + '-' + mm + '-' + dd;
    birthdateInput.setAttribute('max', formattedToday);
  </script>
</body>
</html>